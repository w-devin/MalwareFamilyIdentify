rule sus_behaviour : RULE_TAG
{
    meta:
        author = "w-devin<Mr.wyw@foxmail.com>"
        description = "bash script"
        date = "2020-11-10"
        reference = "REFERENCE"
    strings:
        $download_1 = "curl" wide ascii
        $download_2 = "wget" wide ascii
        $service_opr_1 = "service" wide ascii
        $service_opr_2 = "systemctl" wide ascii
        $command_run_1 = /\|\s?bash/ wide ascii
        $special_dir_1 = "/var/tmp" wide ascii
        $special_dir_2 = "/tmp" wide ascii
        $delete_folders = "rm -rf" wide ascii
        $permission_opr_1 = "chmod" wide ascii
        $kill_process_1 = "kill -9" wide ascii
        $kill_process_2 = "killall" wide ascii
        $kill_process_3 = "pkill -f" wide ascii
        $vis_know_hosts = ".ssh/known_hosts" wide ascii
        $vis_rsa_pub = ".ssh/id_rsa.pub" wide ascii
        $crontab_opr = "crontab" wide ascii
        $clear_history = "echo > /root/.bash_history" wide ascii
        $clear_log = "echo > /var/log/" wide ascii
    condition:
        3 of them
}